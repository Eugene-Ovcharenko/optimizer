from datetime import datetime
from .logger_leaflet import log_message
import numpy as np

def write_inp_beam(fileName=None, JobName='test', ModelName='test', partName='test', Width=10, THK=3):
    fileID = open(fileName, 'w')

    fileID.write('*Heading\n')
    fileID.write('** Job name: %s Model name: %s\n' % (JobName, ModelName))
    fileID.write('** Generated by: LNB\n')
    fileID.write('*Preprint, echo=NO, model=NO, history=NO, contact=NO\n')
    fileID.write('**\n')
    fileID.write('** PARTS\n')
    fileID.write('**\n')
    fileID.write('*Part, name=%s\n' % (partName))
    fileID.write(f'*Node\n')
    fileID.write(f'      1,           0.,           0.\n')
    fileID.write(f'      2,          10.,           0.\n')
    fileID.write(f'      3,          20.,           0.\n')
    fileID.write(f'      4,          30.,           0.\n')
    fileID.write(f'      5,          40.,           0.\n')
    fileID.write(f'      6,          50.,           0.\n')
    fileID.write(f'      7,          60.,           0.\n')
    fileID.write(f'      8,          70.,           0.\n')
    fileID.write(f'      9,          80.,           0.\n')
    fileID.write(f'     10,          90.,           0.\n')
    fileID.write(f'     11,         100.,           0.\n')
    fileID.write(f'*Element, type=B21\n')
    fileID.write(f' 1,  1,  2\n')
    fileID.write(f' 2,  2,  3\n')
    fileID.write(f' 3,  3,  4\n')
    fileID.write(f' 4,  4,  5\n')
    fileID.write(f' 5,  5,  6\n')
    fileID.write(f' 6,  6,  7\n')
    fileID.write(f' 7,  7,  8\n')
    fileID.write(f' 8,  8,  9\n')
    fileID.write(f' 9,  9, 10\n')
    fileID.write(f'10, 10, 11\n')
    fileID.write(f'*Nset, nset=_PickedSet3, internal, generate\n')
    fileID.write(f'  1,  11,   1\n')
    fileID.write(f'*Elset, elset=_PickedSet3, internal, generate\n')
    fileID.write(f'  1,  10,   1\n')
    fileID.write(f'** Section: Shelf_section  Profile: Rect_profile\n')
    fileID.write(f'*Beam Section, elset=_PickedSet3, material=Steel, poisson = 0.3, temperature=GRADIENTS, section=RECT\n')
    fileID.write(f'{Width}, {THK}\n')
    fileID.write(f'0.,0.,-1.\n')
    fileID.write(f'*End Part\n')
    fileID.write(f'**\n')

    fileID.write(f'**\n')
    fileID.write(f'** ASSEMBLY\n')
    fileID.write(f'**\n')
    fileID.write(f'*Assembly, name=Assembly\n')
    fileID.write(f'**\n')
    fileID.write(f'*Instance, name=%s-1, part=%s\n' % (partName, partName))
    fileID.write(f'*End Instance\n')
    fileID.write(f'**\n')
    fileID.write(f'*Nset, nset=_PickedSet4, internal, instance=%s-1\n' % (partName))
    fileID.write(f' 1,\n')
    fileID.write(f'*Nset, nset=_PickedSet5, internal, instance=%s-1\n' % (partName))
    fileID.write(f' 11,\n')
    fileID.write(f'*End Assembly\n')
    fileID.write(f'*Amplitude, name=Amp-1\n')
    fileID.write(f'             0.,              0.,              1.,              1.\n')

    fileID.write(f'**\n')
    fileID.write(f'** MATERIALS\n')
    fileID.write(f'**\n')
    fileID.write(f'*Material, name=Steel\n')
    fileID.write(f'*Elastic\n')
    fileID.write(f'200000., 0.3\n')
    fileID.write(f'** ----------------------------------------------------------------\n')

    fileID.write(f'**\n')
    fileID.write(f'** STEP: Load\n')
    fileID.write(f'**\n')
    fileID.write(f'*Step, name=Load, nlgeom=NO, inc=1000\n')
    fileID.write(f'*Static\n')
    fileID.write(f'0.1, 1., 1e-05, 0.1\n')

    fileID.write(f'**\n')
    fileID.write(f'** BOUNDARY CONDITIONS\n')
    fileID.write(f'**\n')
    fileID.write(f'** Name: Fix Type: Symmetry/Antisymmetry/Encastre\n')
    fileID.write(f'*Boundary\n')
    fileID.write(f'_PickedSet4, ENCASTRE\n')

    fileID.write(f'**\n')
    fileID.write(f'** LOADS\n')
    fileID.write(f'**\n')
    fileID.write(f'** Name: Load_1kN   Type: Concentrated force\n')
    fileID.write(f'*Cload, amplitude=Amp-1\n')
    fileID.write(f'_PickedSet5, 2, -100.\n')

    fileID.write(f'**\n')
    fileID.write(f'** OUTPUT REQUESTS\n')
    fileID.write(f'**\n')
    fileID.write(f'*Restart, write, frequency=0\n')

    fileID.write(f'**\n')
    fileID.write(f'** FIELD OUTPUT: F-Output-1\n')
    fileID.write(f'**\n')
    fileID.write('*Output, field\n')
    fileID.write('*Node Output\n')
    fileID.write('U,\n')
    fileID.write('*Output, field\n')
    fileID.write('*Element Output, directions=YES\n')
    fileID.write('S,\n')


    fileID.write(f'**\n')
    fileID.write(f'** HISTORY OUTPUT: H-Output-1\n')
    fileID.write(f'**\n')
    fileID.write(f'*Output, history, variable=PRESELECT\n')
    fileID.write(f'*End Step\n')
    fileID.close()


def write_inp_shell(fileName=None, Nodes=None, Elements=None, BCfix=None, THC=None, Emod=-1, Dens=1e-9,
                        JobName=None, ModelName=None, partName=None, tangent_behavior=0.2, normal_behavior=0.2,
                        Time=1.0, frequencyOutput=40, scaligFactor=49, MaterialName='Biomat', PressType='ao',
                        press_overclosure='hard'):
    tt2 = datetime.now()
    fileID = open(fileName, 'w')
    ElementType = 'S3'
    fileID.write('*Heading\n')
    fileID.write('** Job name: %s Model name: %s\n' % (JobName, ModelName))
    fileID.write('** Generated by: LNB\n')
    fileID.write('*Preprint, echo=NO, model=NO, history=NO, contact=NO\n')
    fileID.write('**\n')
    fileID.write('** PARTS\n')
    fileID.write('**\n')
    fileID.write('*Part, name=%s\n' % (partName))
    fileID.write('*Node\n')
    for i in np.arange(0, len(Nodes)):
        fileID.write('\t%d' % (i + 1))
        for j in np.arange(0, 3):
            fileID.write(',\t%14.10f' % (Nodes[i, j]))
        fileID.write('\n')

    fileID.write('*Element, type=%s\n' % (ElementType))
    for i in np.arange(0, len(Elements)):
        fileID.write('\t%6d' % (i + 1))
        for j in np.arange(0, 3):
            fileID.write(',\t%6d' % (Elements[i, j] + 1))
        fileID.write('\n')

    fileID.write('*Nset, nset=Set-1, generate\n')
    fileID.write('\t%d,\t%d,\t%d\n' % (1, len(Nodes), 1))
    fileID.write('*Elset, elset=Set-2, generate\n')
    fileID.write('\t%d,\t%d,\t%d\n' % (1, len(Elements), 1))
    fileID.write('** Section: Section-1-Set-2\n')
    fileID.write('*Shell Section, elset=Set-2, material=Biomat\n%f, 9\n*End Part\n' % (THC))
    fileID.write('**\n')
    fileID.write('**\n')
    fileID.write('** ASSEMBLY\n')
    fileID.write('**\n')
    fileID.write('*Assembly, name=Assembly\n')
    fileID.write('**\n')
    fileID.write('*Instance, name=%s-1, part=%s\n' % (partName, partName))
    fileID.write('*End Instance\n')
    fileID.write('**\n')
    fileID.write('*Nset, nset=FixedSet, instance=%s-1\n' % (partName))
    for i in np.arange(0, len(BCfix)):
        if np.mod(i, 16) != 0:
            fileID.write('\t%d,' % (BCfix[i] + 1))
        else:
            fileID.write('\t%d\n' % (BCfix[i] + 1))

    fileID.write('\n*Elset, elset=ElSet_1_SNEG, instance=%s-1, generate\n' % (partName))
    fileID.write('\t1,\t%d,\t1\n' % (len(Elements)))
    fileID.write('*Surface, type=ELEMENT, name=ElSet_Aort\n')
    fileID.write('ElSet_1_SNEG, SNEG\n')
    fileID.write('*Elset, elset=ElSet_2_SPOS, instance=%s-1, generate\n' % (partName))
    fileID.write('\t1,\t%d,\t1\n' % (len(Elements)))
    fileID.write('*Surface, type=ELEMENT, name=ElSet_Vent\n')
    fileID.write('ElSet_2_SPOS, SPOS\n')
    fileID.write('*Nset, nset=OutputNodes, instance=%s-1, generate\n' % (partName))
    fileID.write('	1,	%d,	1\n' % (len(Nodes)))
    fileID.write('*Elset, elset=OutputElements, instance=%s-1, generate\n' % (partName))
    fileID.write('	1,	%d,	1\n' % (len(Elements)))
    fileID.write('*Transform, nset=FixedSet, type=C\n')
    fileID.write('          0.,           0.,           0.,           0.,           0.,           1.\n')
    fileID.write('*End Assembly\n')
    fileID.write('*Amplitude, name=Amp-Aortic\n')
    fileID.write(
        '             0.,          0.0103,           0.025,          0.0107,            0.05,          0.0113,           0.075,          0.0124\n')
    fileID.write(
        '            0.1,           0.014,           0.125,          0.0153,            0.15,          0.0165,           0.175,          0.0172\n')
    fileID.write('            0.2,          0.0178\n')
    fileID.write('*Amplitude, name=Amp-Ventricular\n')
    fileID.write(
        '             0.,          0.0093,           0.025,          0.0129,            0.05,          0.0131,           0.075,           0.014\n')
    fileID.write(
        '            0.1,          0.0149,           0.125,          0.0156,            0.15,          0.0165,           0.175,          0.0173\n')
    fileID.write('            0.2,          0.0179\n')
    fileID.write('**\n')
    fileID.write('** MATERIALS\n')
    fileID.write('**\n')
    fileID.write('*Material, name=Biomat\n')
    fileID.write('*Density\n')
    fileID.write(' 1e-09,\n')
    fileID.write('*Elastic\n')
    fileID.write('%f, 0.45\n' % (Emod))
    fileID.write('**\n')
    fileID.write('** BOUNDARY CONDITIONS\n')
    fileID.write('**\n')
    fileID.write('** Name: BC-1 Type: Symmetry/Antisymmetry/Encastre\n')
    fileID.write('*Boundary\n')
    fileID.write('FixedSet, ENCASTRE\n')
    fileID.write('** ----------------------------------------------------------------\n')
    fileID.write('**\n')
    fileID.write('** STEP: Step-1\n')
    fileID.write('**\n')
    fileID.write('*Step, name=Step-1, nlgeom=YES\n')
    fileID.write('*Dynamic, Explicit\n')
    fileID.write(', 0.2\n')
    fileID.write('*Bulk Viscosity\n')
    fileID.write('0.06, 1.2\n')
    fileID.write('**\n')
    fileID.write('** LOADS\n')
    fileID.write('**\n')

    fileID.write('** Name: LoadVentricular   Type: Pressure\n')
    fileID.write('*Dsload, amplitude=Amp-Ventricular\n')
    fileID.write('ElSet_Vent, P, 1\n')

    fileID.write('** Name: LoadAortic   Type: Pressure\n')
    fileID.write('*Dsload, amplitude=Amp-Aortic\n')
    fileID.write('ElSet_Aort, P, 1\n')

    fileID.write('** Name: ViscoPress  Type: Pressure\n')
    fileID.write('*Dsload\n')
    fileID.write('ElSet_Vent, VP, 1e-06\n')

    fileID.write('**\n')
    fileID.write('** OUTPUT REQUESTS\n')
    fileID.write('**\n')
    fileID.write('*Restart, write, number interval=1, time marks=NO\n')

    fileID.write('** \n')
    fileID.write('** FIELD OUTPUT: F-Output-1\n')
    fileID.write('** \n')
    fileID.write('*Output, field, frequency=%d\n' % (20))
    fileID.write('*Element Output, position=NODES, elset=OUTPUTELEMENTS, directions=YES\n')
    fileID.write('LE, S\n')

    fileID.write('** \n')
    fileID.write('** FIELD OUTPUT: F-Output-2\n')
    fileID.write('** \n')
    fileID.write('*Output, field, frequency=%d\n' % (20))
    fileID.write('*Node Output, nset=OUTPUTNODES\n')
    fileID.write('U, \n')

    fileID.write('** \n')
    fileID.write('** HISTORY OUTPUT: H-Output-1\n')
    fileID.write('** \n')
    fileID.write('*Output, history\n')
    fileID.write('*Energy Output\n')
    fileID.write('ALLAE, ALLIE, ALLKE, ALLSE, ALLWK, ETOTAL\n')
    fileID.write('*End Step\n')
    fileID.close()
    delta = datetime.now() - tt2
    log_message('Total time is > ' + str(delta.seconds) + ' seconds')


def write_inp_contact(fileName=None, Nodes=None, Elements=None, BCfix=None, THC=None, Emod=-1, Dens=1e-9,
                      JobName=None, ModelName=None, partName=None, tangent_behavior=0.2, normal_behavior=0.2,
                      Time=1.0, frequencyOutput=40, scaligFactor=49, MaterialName='Biomat', PressType='ao',
                      press_overclosure='hard'):
    tt2 = datetime.now()
    fileID = open(fileName, 'w')
    ElementType = 'S3'
    fileID.write('*Heading\n')
    fileID.write('** Job name: %s Model name: %s\n' % (JobName, ModelName))
    fileID.write('** Generated by: LNB\n')
    fileID.write('*Preprint, echo=NO, model=NO, history=NO, contact=NO\n')
    fileID.write('**\n')
    fileID.write('** PARTS\n')
    fileID.write('**\n')
    fileID.write('*Part, name=%s\n' % (partName))
    fileID.write('*Node\n')
    for i in np.arange(0, len(Nodes)):
        fileID.write('\t%d' % (i + 1))
        for j in np.arange(0, 3):
            fileID.write(',\t%14.10f' % (Nodes[i, j]))
        fileID.write('\n')

    fileID.write('*Element, type=%s\n' % (ElementType))
    for i in np.arange(0, len(Elements)):
        fileID.write('\t%6d' % (i + 1))
        for j in np.arange(0, 3):
            fileID.write(',\t%6d' % (Elements[i, j] + 1))
        fileID.write('\n')

    fileID.write('*Nset, nset=Set-1, generate\n')
    fileID.write('\t%d,\t%d,\t%d\n' % (1, len(Nodes), 1))
    fileID.write('*Elset, elset=Set-2, generate\n')
    fileID.write('\t%d,\t%d,\t%d\n' % (1, len(Elements), 1))
    fileID.write('** Section: Section-1-Set-2\n')
    fileID.write('*Shell Section, elset=Set-2, material=%s, offset=SPOS\n%f, 9\n*End Part\n' % (MaterialName, THC))
    fileID.write('**\n')

    fileID.write('**\n')
    fileID.write('** ASSEMBLY\n')
    fileID.write('**\n')
    fileID.write('*Assembly, name=Assembly\n')
    fileID.write('**\n')
    fileID.write('*Instance, name=%s-1, part=%s\n' % (partName, partName))
    fileID.write('*End Instance\n')
    fileID.write('**\n')
    fileID.write('*Instance, name=%s-2, part=%s\n' % (partName, partName))
    fileID.write('0., 0., 0.\n')
    fileID.write('0., 0., 0., 0., 0., -1, 120.\n')
    fileID.write('*End Instance\n')
    fileID.write('**\n')
    fileID.write('*Instance, name=%s-3, part=%s\n' % (partName, partName))
    fileID.write('0., 0., 0.\n')
    fileID.write('0., 0., 0., 0., 0., 1, 120.\n')
    fileID.write('*End Instance\n')
    fileID.write('**\n')
    for j in range(1, 4):
        fileID.write('\n*Nset, nset=FixedSet_%d, instance=%s-%d\n' % (j, partName, j))
        for i in np.arange(1, len(BCfix) + 1):
            if np.mod(i, 16) != 0:
                fileID.write('\t%6d,' % (BCfix[i - 1] + 1))
            else:
                fileID.write('\t%6d\n' % (BCfix[i - 1] + 1))
    fileID.write('\n')
    for i in range(1, 4):
        fileID.write('*Elset, elset=_ElSet_%d_SNEG, internal, instance=%s-%d, generate\n' % (i, partName, i))
        fileID.write('\t1,\t%d,\t1\n' % (len(Elements)))
        fileID.write('*Surface, type=ELEMENT, name=ElSet_Aort_%d\n' % (i))
        fileID.write('\t_ElSet_%d_SNEG, SNEG\n' % (i))
        fileID.write('*Elset, elset=_ElSet_%d_SPOS, internal, instance=%s-%d, generate\n' % (i, partName, i))
        fileID.write('\t1,\t%d,\t1\n' % (len(Elements)))
        fileID.write('*Surface, type=ELEMENT, name=ElSet_Vent_%d\n' % (i))
        fileID.write('\t_ElSet_%d_SPOS, SPOS\n' % (i))
    for i in range(1, 4):
        fileID.write('*Nset, nset=OutputNodes_%d, instance=%s-%d, generate\n' % (i, partName, i))
        fileID.write('	1,	%d,	1\n' % (len(Nodes)))
        fileID.write('*Elset, elset=OutputElements_%d, instance=%s-%d, generate\n' % (i, partName, i))
        fileID.write('	1,	%d,	1\n' % (len(Elements)))
        fileID.write('*Transform, nset=FixedSet_%d, type=C\n' % (i))
        fileID.write('          0.,           0.,           0.,           0.,           0.,           1.\n')
    fileID.write('*End Assembly\n')

    fileID.write('*Amplitude, name=Amp-Aortic\n')
    fileID.write(
        '             0.,           0.,                0.01,         0.0005,            0.02,         0.00125,           0.03,         0.002\n')
    fileID.write(
        '             0.04,         0.003,             0.05,         0.00425,           0.06,         0.00575,           0.07,         0.007\n')
    fileID.write(
        '             0.08,         0.008,             0.09,         0.009,             0.1,          0.01,              0.106,        0.010647\n')
    fileID.write(
        '             0.112,        0.010589,          0.13,         0.010474,          0.151,        0.010474,          0.17,         0.010704\n')
    fileID.write(
        '             0.181,        0.011107,          0.19,         0.011452,          0.2,          0.011395,          0.209,        0.011567\n')
    fileID.write(
        '             0.213,        0.011855,          0.217,        0.0122,            0.226,        0.012718,          0.238,        0.012718\n')
    fileID.write(
        '             0.247,        0.012776,          0.254,        0.013121,          0.263,        0.013524,          0.273,        0.013524\n')
    fileID.write(
        '             0.285,        0.013927,          0.29,         0.014042,          0.3,          0.01433,           0.318,        0.01433\n')
    fileID.write(
        '             0.333,        0.014675,          0.349,        0.015078,          0.378,        0.015135,          0.394,        0.015135\n')
    fileID.write(
        '             0.4,          0.014905,          0.409,        0.015251,          0.423,        0.015481,          0.447,        0.015423\n')
    fileID.write(
        '             0.471,        0.015366,          0.488,        0.015135,          0.508,        0.01502,           0.527,        0.014675\n')
    fileID.write(
        '             0.549,        0.01433,           0.584,        0.013466,          0.604,        0.013236,          0.623,        0.013294\n')
    fileID.write(
        '             0.635,        0.013409,          0.649,        0.013639,          0.67,         0.013984,          0.699,        0.014215\n')
    fileID.write(
        '             0.733,        0.014617,          0.776,        0.014445,          0.791,        0.014215,          0.817,        0.013754\n')
    fileID.write(
        '             0.849,        0.012833,          0.871,        0.012315,          0.9,          0.011567,          0.929,        0.011049\n')

    fileID.write('*Amplitude, name=Amp-Ventricular\n')
    fileID.write('             0., 0., 0.01, 0., 0.02, 0., 0.03, 0.\n')
    fileID.write('             0.04, 0., 0.05, 0., 0.06, 0., 0.07, 0.\n')
    fileID.write('             0.08, 0., 0.09, 0., 0.1, 0., 0.109, -0.000403\n')
    fileID.write('             0.118, -0.000345, 0.135, 5.8e-05, 0.146, 0.000518, 0.148, 0.001209\n')
    fileID.write('             0.154, 0.002762, 0.155, 0.003741, 0.157, 0.005122, 0.16, 0.006618\n')
    fileID.write('             0.164, 0.00823, 0.167, 0.009553, 0.17, 0.011049, 0.171, 0.012143\n')
    fileID.write('             0.175, 0.012776, 0.178, 0.013179, 0.184, 0.013006, 0.186, 0.012603\n')
    fileID.write('             0.189, 0.012028, 0.192, 0.011855, 0.193, 0.01174, 0.196, 0.01174\n')
    fileID.write('             0.198, 0.011798, 0.202, 0.012085, 0.203, 0.012258, 0.205, 0.012488\n')
    fileID.write('             0.208, 0.013006, 0.213, 0.013351, 0.215, 0.013582, 0.219, 0.013524\n')
    fileID.write('             0.223, 0.013409, 0.228, 0.013409, 0.236, 0.013754, 0.241, 0.014215\n')
    fileID.write('             0.245, 0.014387, 0.252, 0.014445, 0.258, 0.014272, 0.266, 0.01433\n')
    fileID.write('             0.271, 0.01456, 0.275, 0.014733, 0.285, 0.014905, 0.293, 0.01502\n')
    fileID.write('             0.303, 0.015135, 0.311, 0.015251, 0.319, 0.015366, 0.329, 0.015653\n')
    fileID.write('             0.333, 0.015768, 0.339, 0.015768, 0.348, 0.015596, 0.351, 0.015538\n')
    fileID.write('             0.359, 0.015538, 0.368, 0.015653, 0.379, 0.015884, 0.385, 0.015941\n')
    fileID.write('             0.388, 0.015826, 0.394, 0.015884, 0.399, 0.015941, 0.404, 0.015826\n')
    fileID.write('             0.408, 0.015768, 0.415, 0.015711, 0.421, 0.015884, 0.429, 0.015941\n')
    fileID.write('             0.438, 0.015768, 0.444, 0.015423, 0.455, 0.015251, 0.463, 0.015251\n')
    fileID.write('             0.476, 0.015308, 0.486, 0.015193, 0.493, 0.015135, 0.504, 0.014848\n')
    fileID.write('             0.511, 0.014675, 0.524, 0.014502, 0.532, 0.014387, 0.539, 0.014215\n')
    fileID.write('             0.545, 0.014157, 0.551, 0.014157, 0.559, 0.014215, 0.564, 0.014042\n')
    fileID.write('             0.57, 0.013582, 0.577, 0.012949, 0.583, 0.011798, 0.587, 0.011049\n')
    fileID.write('             0.589, 0.010014, 0.592, 0.008517, 0.5921, 0.006906, 0.594, 0.005295\n')
    fileID.write('             0.596, 0.004259, 0.599, 0.003165, 0.601, 0.001726, 0.602, 0.000345\n')
    fileID.write('             0.6021, -0.000863, 0.603, -0.001842, 0.604, -0.00282, 0.607, -0.004201\n')
    fileID.write('             0.61, -0.005064, 0.612, -0.005582, 0.613, -0.005467, 0.616, -0.005237\n')
    fileID.write('             0.617, -0.004374, 0.621, -0.002993, 0.6211, -0.001899, 0.623, -0.001439\n')
    fileID.write('             0.626, -0.000575, 0.628, 0.000288, 0.632, 0.000633, 0.635, 0.000115\n')
    fileID.write('             0.636, -0.000345, 0.639, -0.001036, 0.645, -0.002187, 0.648, -0.002993\n')
    fileID.write('             0.651, -0.00305, 0.655, -0.00282, 0.658, -0.002244, 0.661, -0.001726\n')
    fileID.write('             0.666, -0.001611, 0.67, -0.001669, 0.677, -0.002129, 0.684, -0.00236\n')
    fileID.write('             0.688, -0.002475, 0.692, -0.002417, 0.702, -0.002014, 0.713, -0.001784\n')
    fileID.write('             0.718, -0.002129, 0.729, -0.002647, 0.736, -0.002647, 0.744, -0.002302\n')
    fileID.write('             0.753, -0.001957, 0.761, -0.002244, 0.77, -0.002647, 0.775, -0.002705\n')
    fileID.write('             0.782, -0.00259, 0.791, -0.002187, 0.799, -0.001842, 0.812, -0.001784\n')
    fileID.write('             0.823, -0.001899, 0.833, -0.001669, 0.846, -0.001209, 0.851, -0.001093\n')
    fileID.write('             0.859, -0.001209, 0.866, -0.001324, 0.875, -0.001036, 0.882, -0.000806\n')
    fileID.write('             0.892, -0.000575, 0.904, -0.000518, 0.914, -0.000575, 0.926, -0.000575\n')
    fileID.write('             0.934, -0.000518, 0.944, -0.000403, 0.956, -0.000288\n')

    if Emod != -1:
        fileID.write('**\n')
        fileID.write('** MATERIALS\n')
        fileID.write('**\n')
        fileID.write('*Material, name=%s\n' % (MaterialName))
        fileID.write('*Density\n')
        fileID.write(' %.2e,\n' % (Dens))
        fileID.write('*Elastic\n')
        fileID.write('%f, 0.495\n' % (Emod))
    else:
        ## material properties
        fileID.write('**\n' % ())
        fileID.write('** MATERIALS\n' % ())
        fileID.write('**\n' % ())
        fileID.write('*Material, name=%s\n' % (MaterialName))
        fileID.write('*Density\n' % ())
        fileID.write(' 1e-09,\n' % ())
        fileID.write('*Hyperelastic, n=2, reduced polynomial, test data input, poisson=0.495\n' % ())
        fileID.write('*Uniaxial Test Data\n' % ())
        # pericard
        fileID.write('    0.,   0.\n' % ())
        fileID.write('  0.01, 0.04\n' % ())
        fileID.write(' 0.095, 0.09\n' % ())
        fileID.write('   0.2, 0.13\n' % ())
        fileID.write('   0.5,  0.2\n' % ())
        fileID.write('   1.5, 0.25\n' % ())
        fileID.write('   2.5,  0.3\n' % ())
        fileID.write('   3.5, 0.35\n' % ())
        fileID.write('    5., 0.45\n' % ())

    fileID.write('** \n')
    fileID.write('** INTERACTION PROPERTIES\n')
    fileID.write('** \n')
    fileID.write('*Surface Interaction, name = IntProp-1\n')
    fileID.write('*Friction\n')
    fileID.write(' %f,\n' % (tangent_behavior))
    if str.lower(press_overclosure) == 'hard':
        fileID.write('*Surface Behavior, pressure-overclosure=HARD\n')
    elif str.lower(press_overclosure) == 'linear':
        fileID.write('*Surface Behavior, pressure-overclosure=LINEAR\n')
        fileID.write('%f,\n' % (normal_behavior))

    fileID.write('**\n')
    fileID.write('** BOUNDARY CONDITIONS\n')
    fileID.write('**\n')
    fileID.write('** Name: BC-1 Type: Symmetry/Antisymmetry/Encastre\n')
    fileID.write('*Boundary\n')
    fileID.write('FixedSet_1, ENCASTRE\n')
    fileID.write('** Name: BC-2 Type: Symmetry/Antisymmetry/Encastre\n')
    fileID.write('*Boundary\n')
    fileID.write('FixedSet_2, ENCASTRE\n')
    fileID.write('** Name: BC-3 Type: Symmetry/Antisymmetry/Encastre\n')
    fileID.write('*Boundary\n')
    fileID.write('FixedSet_3, ENCASTRE\n')

    fileID.write('** ----------------------------------------------------------------\n')
    fileID.write('**\n')
    fileID.write('** STEP: Step-1\n')
    fileID.write('**\n')
    fileID.write('*Step, name=Step-1, nlgeom=YES\n')
    fileID.write('*Dynamic, Explicit\n')
    fileID.write(', %f\n' % (Time))
    fileID.write('*Bulk Viscosity\n')
    fileID.write('0.06, 1.2\n')
    fileID.write('** Mass Scaling: Semi-Automatic\n')
    fileID.write('** Whole Model\n')
    fileID.write('*Fixed Mass Scaling, factor = %f\n' % (scaligFactor))

    fileID.write('**\n')
    fileID.write('** LOADS\n')
    fileID.write('**\n')

    for iter_Part in range(1, 4):
        if PressType == 'ao':
            fileID.write('** Name: LoadVentricular-%d   Type: Pressure\n' % (iter_Part))
            fileID.write('*Dsload, amplitude=Amp-Ventricular\n')
            fileID.write('ElSet_Vent_%d, P, 1.\n' % (iter_Part))

            fileID.write('** Name: LoadAortic-%d   Type: Pressure\n' % (iter_Part))
            fileID.write('*Dsload, amplitude=Amp-Aortic\n')
            fileID.write('ElSet_Aort_%d, P, 1.\n' % (iter_Part))
        else:
            fileID.write('** Name: LoadVentricular-%d   Type: Pressure\n' % (iter_Part))
            fileID.write('*Dsload, amplitude=Amp-Ventricular\n')
            fileID.write('ElSet_Vent_%d, P, -1.\n' % (iter_Part))

        fileID.write('** Name: ViscoPress-%d   Type: Pressure\n' % (iter_Part))
        fileID.write('*Dsload\n')
        fileID.write('ElSet_Vent_%d, VP, 1e-05\n' % (iter_Part))

    fileID.write('**\n')
    fileID.write('** INTERACTIONS\n')
    fileID.write('**\n')
    fileID.write('** Interaction: Int-1-2\n')
    fileID.write('*Contact Pair, interaction=IntProp-1, mechanical constraint=KINEMATIC, cpset=Int-1-2\n')
    fileID.write('ElSet_Vent_1, ElSet_Vent_2\n')
    fileID.write('** Interaction: Int-2-3\n')
    fileID.write('*Contact Pair, interaction=IntProp-1, mechanical constraint=KINEMATIC, cpset=Int-2-3\n')
    fileID.write('ElSet_Vent_2, ElSet_Vent_3\n')
    fileID.write('** Interaction: Int-3-1\n')
    fileID.write('*Contact Pair, interaction=IntProp-1, mechanical constraint=KINEMATIC, cpset=Int-3-1\n')
    fileID.write('ElSet_Vent_3, ElSet_Vent_1\n')

    fileID.write('**\n' % ())
    fileID.write('** OUTPUT REQUESTS\n' % ())
    fileID.write('**\n' % ())
    fileID.write('*Restart, write, number interval=1, time marks=NO\n' % ())
    for i in range(1, 4):
        fileID.write('**\n' % ())
        fileID.write('** FIELD OUTPUT: F-Output-1-%d\n' % (i))
        fileID.write('**\n' % ())
        fileID.write('*Output, field, frequency=%d\n' % (frequencyOutput))
        fileID.write('*Node Output, nset=OutputNodes_%d\n' % (i))
        fileID.write('RT, U\n' % ())
    for i in range(1, 4):
        fileID.write('**\n' % ())
        fileID.write('** FIELD OUTPUT: F-Output-2-%d\n' % (i))
        fileID.write('**\n' % ())
        fileID.write('*Output, field, frequency=%d\n' % (frequencyOutput))
        fileID.write('*Element Output, position=NODES, elset=OutputElements_%d, directions=YES\n' % (i))
        fileID.write('LE, S\n' % ())
    for i in range(1, 4):
        if i < 3:
            j = i + 1
        else:
            j = 1
        fileID.write('** \n' % ())
        fileID.write('** HISTORY OUTPUT: H-Output-%d\n' % (i))
        fileID.write('** \n' % ())
        fileID.write('*Output, history, frequency=%d\n' % (frequencyOutput))
        fileID.write('*Contact Output, cpset=Int-%d-%d\n' % (i, j))
        fileID.write('CAREA,\n' % ())

    fileID.write('*End Step\n' % ())
    fileID.close()
    delta = datetime.now() - tt2
    log_message('Inp file creation is > ' + str(delta.seconds) + ' seconds')